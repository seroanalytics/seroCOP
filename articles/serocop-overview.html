<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>SeroCOP Overview • seroCOP</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="SeroCOP Overview">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">seroCOP</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html" aria-label="Home"><span class="fa fas fa-home fa-lg"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/simulation-recovery.html">Simulation and Recovery</a></li>
    <li><a class="dropdown-item" href="../articles/multi-biomarker.html">Multi-Biomarker Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/serocop-overview.html">Overview of seroCOP</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/seroanalytics/seroCOP" aria-label="GitHub Repository"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>SeroCOP Overview</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/seroanalytics/seroCOP/blob/main/vignettes/serocop-overview.Rmd" class="external-link"><code>vignettes/serocop-overview.Rmd</code></a></small>
      <div class="d-none name"><code>serocop-overview.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview-of-serocop">Overview of SeroCOP<a class="anchor" aria-label="anchor" href="#overview-of-serocop"></a>
</h2>
<p>This vignette provides a comprehensive overview of the
<code>SeroCOP</code> R6 class, including its options, functions, and
usage. The <code>SeroCOP</code> class is designed for Bayesian analysis
of correlates of protection using Stan.</p>
<div class="section level3">
<h3 id="key-features">Key Features<a class="anchor" aria-label="anchor" href="#key-features"></a>
</h3>
<ul>
<li>Flexible prior distributions.</li>
<li>Multi-biomarker analysis.</li>
<li>Model fitting and parameter extraction.</li>
<li>Visualization tools.</li>
</ul>
</div>
<div class="section level3">
<h3 id="model-description">Model Description<a class="anchor" aria-label="anchor" href="#model-description"></a>
</h3>
<p>The <code>SeroCOP</code> model is based on a logistic regression
framework, which models the probability of protection as a function of
biomarker levels. The logistic function is defined as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Y</mi><mo>=</mo><mn>1</mn><mo stretchy="false" form="prefix">|</mo><mi>X</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo>,</mo></mrow><annotation encoding="application/x-tex">
P(Y = 1 | X) = \frac{1}{1 + \exp(-z)},
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>z</mi><annotation encoding="application/x-tex">z</annotation></semantics></math>
is a linear combination of the predictors:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><mo>=</mo><msub><mi>β</mi><mn>0</mn></msub><mo>+</mo><msub><mi>β</mi><mn>1</mn></msub><msub><mi>X</mi><mn>1</mn></msub><mo>+</mo><msub><mi>β</mi><mn>2</mn></msub><msub><mi>X</mi><mn>2</mn></msub><mo>+</mo><mi>…</mi><mo>+</mo><msub><mi>β</mi><mi>k</mi></msub><msub><mi>X</mi><mi>k</mi></msub><mi>.</mi></mrow><annotation encoding="application/x-tex">
z = \beta_0 + \beta_1 X_1 + \beta_2 X_2 + \dots + \beta_k X_k.
</annotation></semantics></math></p>
<div class="section level4">
<h4 id="parameters">Parameters<a class="anchor" aria-label="anchor" href="#parameters"></a>
</h4>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mn>0</mn></msub><annotation encoding="application/x-tex">\beta_0</annotation></semantics></math>:
Intercept term.</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mn>1</mn></msub><mo>,</mo><msub><mi>β</mi><mn>2</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>β</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">\beta_1, \beta_2, \dots, \beta_k</annotation></semantics></math>:
Coefficients for the predictors.</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mn>1</mn></msub><mo>,</mo><msub><mi>X</mi><mn>2</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>X</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">X_1, X_2, \dots, X_k</annotation></semantics></math>:
Biomarker levels.</li>
</ul>
</div>
<div class="section level4">
<h4 id="priors">Priors<a class="anchor" aria-label="anchor" href="#priors"></a>
</h4>
<p>The <code>SeroCOP</code> model allows you to specify prior
distributions for the parameters. These priors can be tailored to
reflect prior knowledge or assumptions about the parameters.</p>
<div class="section level5">
<h5 id="supported-priors">Supported Priors<a class="anchor" aria-label="anchor" href="#supported-priors"></a>
</h5>
<ul>
<li>
<p><strong>Normal</strong>: Suitable for parameters with symmetric
distributions.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span><span class="op">$</span><span class="fu">definePrior</span><span class="op">(</span>parameter <span class="op">=</span> <span class="st">"beta_1"</span>, distribution <span class="op">=</span> <span class="st">"normal"</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
</li>
<li>
<p><strong>Uniform</strong>: Suitable for parameters with bounded
ranges.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span><span class="op">$</span><span class="fu">definePrior</span><span class="op">(</span>parameter <span class="op">=</span> <span class="st">"beta_2"</span>, distribution <span class="op">=</span> <span class="st">"uniform"</span>, min <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, max <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
</li>
<li>
<p><strong>Beta</strong>: Suitable for probabilities or
proportions.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span><span class="op">$</span><span class="fu">definePrior</span><span class="op">(</span>parameter <span class="op">=</span> <span class="st">"p"</span>, distribution <span class="op">=</span> <span class="st">"beta"</span>, alpha <span class="op">=</span> <span class="fl">2</span>, beta <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
</li>
</ul>
</div>
</div>
</div>
<div class="section level3">
<h3 id="initialization">Initialization<a class="anchor" aria-label="anchor" href="#initialization"></a>
</h3>
<p>To create a new <code>SeroCOP</code> object, use the following:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://seroanalytics.org/seroCOP/">seroCOP</a></span><span class="op">)</span></span>
<span><span class="co"># Example data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">200</span></span>
<span><span class="va">titre</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, mean <span class="op">=</span> <span class="fl">2</span>, sd <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span>
<span><span class="va">prob</span> <span class="op">&lt;-</span> <span class="fl">0.05</span> <span class="op">+</span> <span class="fl">0.9</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="va">titre</span> <span class="op">-</span> <span class="fl">1.5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">infected</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="va">prob</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Initialize the model</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/SeroCOP.html">SeroCOP</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>titre <span class="op">=</span> <span class="va">titre</span>, infected <span class="op">=</span> <span class="va">infected</span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a>
</h4>
<ul>
<li>
<code>titre</code>: Numeric vector of antibody titres.</li>
<li>
<code>infected</code>: Binary vector (0/1) of infection
outcomes.</li>
</ul>
<p>These inputs are required to initialize the <code>SeroCOP</code>
object.</p>
</div>
</div>
<div class="section level3">
<h3 id="prior-options">Prior Options<a class="anchor" aria-label="anchor" href="#prior-options"></a>
</h3>
<p>The <code>definePrior</code> method allows you to specify prior
distributions for the model parameters. Below is a detailed explanation
of each option:</p>
<ul>
<li>
<strong><code>floor_alpha</code></strong>: Alpha parameter for the
Beta prior distribution of the “floor” parameter. Default:
<code>1</code>.</li>
<li>
<strong><code>floor_beta</code></strong>: Beta parameter for the
Beta prior distribution of the “floor” parameter. Default:
<code>9</code>.</li>
<li>
<strong><code>ceiling_alpha</code></strong>: Alpha parameter for the
Beta prior distribution of the “ceiling” parameter. Default:
<code>9</code>.</li>
<li>
<strong><code>ceiling_beta</code></strong>: Beta parameter for the
Beta prior distribution of the “ceiling” parameter. Default:
<code>1</code>.</li>
<li>
<strong><code>ec50_mean</code></strong>: Mean of the Normal prior
distribution for the <code>ec50</code> parameter. Default: Midpoint of
the <code>titre</code> range.</li>
<li>
<strong><code>ec50_sd</code></strong>: Standard deviation of the
Normal prior distribution for the <code>ec50</code> parameter. Default:
One-fourth of the <code>titre</code> range.</li>
<li>
<strong><code>slope_mean</code></strong>: Mean of the Normal prior
distribution for the slope parameter. Default: <code>0</code>.</li>
<li>
<strong><code>slope_sd</code></strong>: Standard deviation of the
Normal prior distribution for the slope parameter. Default:
<code>2</code>.</li>
</ul>
<div class="section level4">
<h4 id="example-usage">Example Usage<a class="anchor" aria-label="anchor" href="#example-usage"></a>
</h4>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span><span class="op">$</span><span class="fu">definePrior</span><span class="op">(</span></span>
<span>  floor_alpha <span class="op">=</span> <span class="fl">2</span>, floor_beta <span class="op">=</span> <span class="fl">18</span>,    <span class="co"># Stronger prior for low floor</span></span>
<span>  ceiling_alpha <span class="op">=</span> <span class="fl">18</span>, ceiling_beta <span class="op">=</span> <span class="fl">2</span>, <span class="co"># Stronger prior for high ceiling</span></span>
<span>  ec50_mean <span class="op">=</span> <span class="fl">1.5</span>, ec50_sd <span class="op">=</span> <span class="fl">0.5</span>,      <span class="co"># Custom ec50 prior</span></span>
<span>  slope_mean <span class="op">=</span> <span class="fl">0</span>, slope_sd <span class="op">=</span> <span class="fl">1</span>         <span class="co"># More conservative slope</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="supported-distributions">Supported Distributions<a class="anchor" aria-label="anchor" href="#supported-distributions"></a>
</h4>
<ul>
<li>Normal</li>
<li>Uniform</li>
<li>Beta</li>
</ul>
</div>
</div>
<div class="section level3">
<h3 id="model-fitting">Model Fitting<a class="anchor" aria-label="anchor" href="#model-fitting"></a>
</h3>
<p>The <code>fit_model</code> method fits the model to the data using
Stan. Example:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="va">model</span><span class="op">$</span><span class="fu">fit_model</span><span class="op">(</span></span>
<span>  chains <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  iter <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>  warmup <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  cores <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="arguments-1">Arguments<a class="anchor" aria-label="anchor" href="#arguments-1"></a>
</h4>
<ul>
<li>
<code>data</code>: The dataset to fit the model to.</li>
<li>
<code>chains</code>: Number of MCMC chains.</li>
<li>
<code>iter</code>: Total number of iterations per chain.</li>
<li>
<code>warmup</code>: Number of warmup iterations.</li>
<li>
<code>cores</code>: Number of CPU cores to use.</li>
</ul>
</div>
</div>
<div class="section level3">
<h3 id="multi-biomarker-analysis">Multi-Biomarker Analysis<a class="anchor" aria-label="anchor" href="#multi-biomarker-analysis"></a>
</h3>
<p>The <code>SeroCOPMulti</code> class extends <code>SeroCOP</code> to
support multi-biomarker analysis. Example:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">data1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  titre <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, mean <span class="op">=</span> <span class="fl">2</span>, sd <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span>,</span>
<span>  infected <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">1</span>, prob <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">data2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  titre <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, mean <span class="op">=</span> <span class="fl">3</span>, sd <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span>,</span>
<span>  infected <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">1</span>, prob <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">multi_model</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/SeroCOPMulti.html">SeroCOPMulti</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  titre <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">data1</span><span class="op">$</span><span class="va">titre</span>, <span class="va">data2</span><span class="op">$</span><span class="va">titre</span><span class="op">)</span>,</span>
<span>  infected <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">data1</span><span class="op">$</span><span class="va">infected</span>, <span class="va">data2</span><span class="op">$</span><span class="va">infected</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">multi_fit</span> <span class="op">&lt;-</span> <span class="va">multi_model</span><span class="op">$</span><span class="fu">fit_all</span><span class="op">(</span></span>
<span>  chains <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  iter <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>  warmup <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  cores <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="example-datasets-for-multi-biomarker-analysis">Example Datasets for Multi-Biomarker analysis<a class="anchor" aria-label="anchor" href="#example-datasets-for-multi-biomarker-analysis"></a>
</h4>
</div>
</div>
<div class="section level3">
<h3 id="visualization">Visualization<a class="anchor" aria-label="anchor" href="#visualization"></a>
</h3>
<p>The <code>plot</code> method provides visualization tools for the
fitted model:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span><span class="op">$</span><span class="fu">plot_curve</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="extracting-parameters">Extracting Parameters<a class="anchor" aria-label="anchor" href="#extracting-parameters"></a>
</h3>
<p>Use the <code>extract_parameters</code> method to extract posterior
samples:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">params</span> <span class="op">&lt;-</span> <span class="va">model</span><span class="op">$</span><span class="fu">extract_parameters</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h3>
<p>The <code>SeroCOP</code> class provides a flexible and powerful
framework for Bayesian analysis of correlates of protection. This
vignette covered the key options and functions available in the class.
For more details, refer to the package documentation.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by David Hodgson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
