[{"path":"https://seroanalytics.org/seroCOP/articles/multi-biomarker.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Multi-Biomarker Analysis with seroCOP","text":"vignette demonstrates analyze multiple biomarkers simultaneously using SeroCOPMulti class. ’ll simulate three biomarkers different correlates protection: Strong CoP: IgG clear protective effect Weak CoP: IgA modest protective effect CoP: Non-specific antibody protective effect","code":""},{"path":"https://seroanalytics.org/seroCOP/articles/multi-biomarker.html","id":"load-the-package","dir":"Articles","previous_headings":"Introduction","what":"Load the package","title":"Multi-Biomarker Analysis with seroCOP","text":"","code":"library(seroCOP) library(ggplot2) set.seed(2025)"},{"path":"https://seroanalytics.org/seroCOP/articles/multi-biomarker.html","id":"simulate-multi-biomarker-data","dir":"Articles","previous_headings":"","what":"Simulate Multi-Biomarker Data","title":"Multi-Biomarker Analysis with seroCOP","text":"’ll create three biomarkers different characteristics:","code":"n <- 250  # Sample size  # Biomarker 1: Strong CoP (IgG) # High ceiling-floor difference, clear dose-response titre_IgG <- rnorm(n, mean = 2.5, sd = 1.2) prob_IgG <- 0.02 + 0.90 / (1 + exp(2.5 * (titre_IgG - 2.0)))  # Biomarker 2: Weak CoP (IgA)   # Moderate ceiling-floor difference, weaker slope titre_IgA <- rnorm(n, mean = 1.8, sd = 1.5) prob_IgA <- 0.15 + 0.50 / (1 + exp(1.0 * (titre_IgA - 1.5)))  # Biomarker 3: No CoP (Non-specific) # No relationship with infection - flat line titre_Nonspec <- rnorm(n, mean = 3.0, sd = 1.0) prob_Nonspec <- rep(0.35, n)  # Constant probability  # Generate infection outcomes # Use weighted average with noise prob_combined <- 0.5 * prob_IgG + 0.3 * prob_IgA + 0.2 * prob_Nonspec infected <- rbinom(n, 1, prob_combined)  # Combine into matrix titre_matrix <- cbind(   IgG = titre_IgG,   IgA = titre_IgA,   Nonspecific = titre_Nonspec )  # Store true parameters for later comparison true_params <- list(   IgG = list(floor = 0.02, ceiling = 0.92, ec50 = 2.0, slope = 2.5),   IgA = list(floor = 0.15, ceiling = 0.65, ec50 = 1.5, slope = 1.0),   Nonspecific = list(floor = 0.35, ceiling = 0.35, ec50 = 3.0, slope = 0.01) )  cat(sprintf(\"Simulated %d samples with 3 biomarkers\\n\", n)) #> Simulated 250 samples with 3 biomarkers cat(sprintf(\"Overall infection rate: %.1f%%\\n\", mean(infected) * 100)) #> Overall infection rate: 34.8%"},{"path":"https://seroanalytics.org/seroCOP/articles/multi-biomarker.html","id":"visualize-simulated-relationships","dir":"Articles","previous_headings":"Simulate Multi-Biomarker Data","what":"Visualize Simulated Relationships","title":"Multi-Biomarker Analysis with seroCOP","text":"","code":"# Create visualization of true relationships plot_data <- data.frame(   titre = c(titre_IgG, titre_IgA, titre_Nonspec),   prob = c(prob_IgG, prob_IgA, prob_Nonspec),   infected = rep(infected, 3),   biomarker = rep(c(\"IgG (Strong CoP)\", \"IgA (Weak CoP)\",                      \"Nonspecific (No CoP)\"), each = n) )  ggplot(plot_data, aes(x = titre, y = prob)) +   geom_line(color = \"red\", linewidth = 1, alpha = 0.7) +   geom_point(aes(y = infected), alpha = 0.3, size = 0.8) +   facet_wrap(~biomarker, scales = \"free_x\") +   labs(     title = \"True Infection Probability by Biomarker\",     x = \"Antibody Titre (log scale)\",     y = \"Probability of Infection\"   ) +   theme_minimal() +   theme(plot.title = element_text(hjust = 0.5, face = \"bold\"))"},{"path":"https://seroanalytics.org/seroCOP/articles/multi-biomarker.html","id":"fit-multi-biomarker-model","dir":"Articles","previous_headings":"","what":"Fit Multi-Biomarker Model","title":"Multi-Biomarker Analysis with seroCOP","text":"Now ’ll use SeroCOPMulti class fit models biomarkers:","code":"# Initialize multi-biomarker model multi_model <- SeroCOPMulti$new(   titre = titre_matrix,   infected = infected,   biomarker_names = c(\"IgG\", \"IgA\", \"Nonspecific\") ) #> SeroCOPMulti initialized with 250 observations and 3 biomarkers #>   Biomarkers: IgG, IgA, Nonspecific #>   Infection rate: 34.8% # Fit all models # Note: Using reduced iterations for vignette speed multi_model$fit_all(   chains = 4,   iter = 1000,   warmup = 500,   cores = 1 ) #> Warning: Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#tail-ess #> Warning: There were 12 divergent transitions after warmup. See #> https://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup #> to find out why this is a problem and how to eliminate them. #> Warning: Examine the pairs() plot to diagnose sampling problems #> Warning: The largest R-hat is 1.07, indicating chains have not mixed. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#r-hat #> Warning: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#bulk-ess"},{"path":[]},{"path":"https://seroanalytics.org/seroCOP/articles/multi-biomarker.html","id":"fitted-curves","dir":"Articles","previous_headings":"Compare Biomarkers","what":"Fitted Curves","title":"Multi-Biomarker Analysis with seroCOP","text":"","code":"multi_model$plot_all_curves()"},{"path":"https://seroanalytics.org/seroCOP/articles/multi-biomarker.html","id":"performance-metrics-comparison","dir":"Articles","previous_headings":"Compare Biomarkers","what":"Performance Metrics Comparison","title":"Multi-Biomarker Analysis with seroCOP","text":"comparison table shows: IgG: High AUC (~0.85-0.95), indicating strong discrimination IgA: Moderate AUC (~0.65-0.75), indicating weak discrimination Nonspecific: Low AUC (~0.45-0.55), better random","code":"comparison <- multi_model$compare_biomarkers() #>  #> === Biomarker Comparison === #>  #>    biomarker       auc auc_lower auc_upper     brier  loo_elpd   loo_se #>          IgG 0.6582046 0.5829271 0.7334822 0.2072601 -154.1994 6.544413 #>          IgA 0.5468585 0.4722618 0.6214551 0.2260122 -162.8842 4.665918 #>  Nonspecific 0.5017982 0.4247284 0.5788680 0.2268769 -163.6162 4.660890"},{"path":"https://seroanalytics.org/seroCOP/articles/multi-biomarker.html","id":"auc-vs-loo-elpd-comparison-plot","dir":"Articles","previous_headings":"Compare Biomarkers","what":"AUC vs LOO-ELPD Comparison Plot","title":"Multi-Biomarker Analysis with seroCOP","text":"plot shows biomarkers positioned predictive performance:  Interpretation: Top-right: Best biomarkers (high AUC, high LOO-ELPD) Bottom-left: Worst biomarkers (low AUC, low LOO-ELPD) Error bars: Uncertainty estimates","code":"multi_model$plot_comparison() #>  #> === Biomarker Comparison === #>  #>    biomarker       auc auc_lower auc_upper     brier  loo_elpd   loo_se #>          IgG 0.6582046 0.5829271 0.7334822 0.2072601 -154.1994 6.544413 #>          IgA 0.5468585 0.4722618 0.6214551 0.2260122 -162.8842 4.665918 #>  Nonspecific 0.5017982 0.4247284 0.5788680 0.2268769 -163.6162 4.660890 #> `height` was translated to `width`."},{"path":"https://seroanalytics.org/seroCOP/articles/multi-biomarker.html","id":"parameter-recovery","dir":"Articles","previous_headings":"","what":"Parameter Recovery","title":"Multi-Biomarker Analysis with seroCOP","text":"Let’s check recovered true parameters biomarker:","code":"# Extract parameters for each biomarker for (biomarker in c(\"IgG\", \"IgA\", \"Nonspecific\")) {   cat(sprintf(\"\\n=== %s ===\\n\", biomarker))      model <- multi_model$models[[biomarker]]   params <- extract_parameters(model)      cat(\"\\nEstimated parameters:\\n\")   print(params[, c(\"parameter\", \"mean\", \"lower\", \"upper\")])      cat(\"\\nTrue parameters:\\n\")   true <- true_params[[biomarker]]   cat(sprintf(\"  floor:   %.3f\\n\", true$floor))   cat(sprintf(\"  ceiling: %.3f\\n\", true$ceiling))   cat(sprintf(\"  ec50:    %.3f\\n\", true$ec50))   cat(sprintf(\"  slope:   %.3f\\n\", true$slope)) } #>  #> === IgG === #>  #> Estimated parameters: #>   parameter      mean      lower     upper #> 1     floor 0.1719731 0.01995582 0.2858089 #> 2   ceiling 0.8729742 0.65037485 0.9961169 #> 3      ec50 1.1228755 0.22232689 2.0414593 #> 4     slope 1.3597713 0.42230112 3.1277511 #>  #> True parameters: #>   floor:   0.020 #>   ceiling: 0.920 #>   ec50:    2.000 #>   slope:   2.500 #>  #> === IgA === #>  #> Estimated parameters: #>   parameter        mean        lower     upper #> 1     floor  0.08839946  0.002603836 0.3310646 #> 2   ceiling  0.79373918  0.522643007 0.9907708 #> 3      ec50 -0.07922047 -3.240520644 3.9734660 #> 4     slope  0.32865864  0.016487435 1.9151297 #>  #> True parameters: #>   floor:   0.150 #>   ceiling: 0.650 #>   ec50:    1.500 #>   slope:   1.000 #>  #> === Nonspecific === #>  #> Estimated parameters: #>   parameter      mean        lower     upper #> 1     floor 0.1511990  0.002941631 0.3597803 #> 2   ceiling 0.7893157  0.539220278 0.9845812 #> 3      ec50 1.4381978 -0.913237426 4.8762568 #> 4     slope 0.8487359  0.012967226 3.7070817 #>  #> True parameters: #>   floor:   0.350 #>   ceiling: 0.350 #>   ec50:    3.000 #>   slope:   0.010"},{"path":"https://seroanalytics.org/seroCOP/articles/multi-biomarker.html","id":"visualize-parameter-recovery","dir":"Articles","previous_headings":"Parameter Recovery","what":"Visualize Parameter Recovery","title":"Multi-Biomarker Analysis with seroCOP","text":"","code":"# Create combined recovery plot recovery_list <- list()  for (i in seq_along(multi_model$biomarker_names)) {   biomarker <- multi_model$biomarker_names[i]   model <- multi_model$models[[biomarker]]   params <- extract_parameters(model)      recovery_list[[i]] <- data.frame(     biomarker = biomarker,     parameter = params$parameter,     estimated = params$mean,     lower = params$lower,     upper = params$upper,     true = c(       true_params[[biomarker]]$floor,       true_params[[biomarker]]$ceiling,       true_params[[biomarker]]$ec50,       true_params[[biomarker]]$slope     )   ) }  recovery_df <- do.call(rbind, recovery_list)  ggplot(recovery_df, aes(x = parameter, color = biomarker)) +   geom_pointrange(     aes(y = estimated, ymin = lower, ymax = upper),     position = position_dodge(width = 0.5),     size = 0.8   ) +   geom_point(     aes(y = true),     shape = 4,     size = 3,     stroke = 1.5,     position = position_dodge(width = 0.5)   ) +   facet_wrap(~parameter, scales = \"free_y\", ncol = 2) +   labs(     title = \"Parameter Recovery Across Biomarkers\",     subtitle = \"Points with bars: Estimated (95% CI) | X: True value\",     y = \"Value\",     color = \"Biomarker\"   ) +   theme_minimal() +   theme(     plot.title = element_text(hjust = 0.5, face = \"bold\"),     plot.subtitle = element_text(hjust = 0.5),     axis.text.x = element_blank(),     axis.title.x = element_blank()   )"},{"path":"https://seroanalytics.org/seroCOP/articles/multi-biomarker.html","id":"individual-roc-curves","dir":"Articles","previous_headings":"","what":"Individual ROC Curves","title":"Multi-Biomarker Analysis with seroCOP","text":"","code":"# Plot ROC curves for each biomarker par(mfrow = c(1, 3))  for (biomarker in multi_model$biomarker_names) {   model <- multi_model$models[[biomarker]]      pred <- colMeans(model$predict())   roc_obj <- pROC::roc(model$infected, pred, quiet = TRUE)      plot(roc_obj,         main = sprintf(\"%s\\nAUC = %.3f\", biomarker, pROC::auc(roc_obj)),        col = \"steelblue\",        lwd = 2)   abline(a = 0, b = 1, lty = 2, col = \"gray\") } par(mfrow = c(1, 1))"},{"path":"https://seroanalytics.org/seroCOP/articles/multi-biomarker.html","id":"cross-validation-results","dir":"Articles","previous_headings":"","what":"Cross-Validation Results","title":"Multi-Biomarker Analysis with seroCOP","text":"","code":"# Compare LOO-CV across biomarkers cat(\"\\n=== Leave-One-Out Cross-Validation Comparison ===\\n\\n\") #>  #> === Leave-One-Out Cross-Validation Comparison ===  for (biomarker in multi_model$biomarker_names) {   cat(sprintf(\"--- %s ---\\n\", biomarker))   model <- multi_model$models[[biomarker]]   print(model$loo)   cat(\"\\n\") } #> --- IgG --- #>  #> Computed from 2000 by 250 log-likelihood matrix. #>  #>          Estimate   SE #> elpd_loo   -154.2  6.5 #> p_loo         3.0  0.3 #> looic       308.4 13.1 #> ------ #> MCSE of elpd_loo is 0.0. #> MCSE and ESS estimates assume independent draws (r_eff=1). #>  #> All Pareto k estimates are good (k < 0.7). #> See help('pareto-k-diagnostic') for details. #>  #> --- IgA --- #>  #> Computed from 2000 by 250 log-likelihood matrix. #>  #>          Estimate  SE #> elpd_loo   -162.9 4.7 #> p_loo         1.8 0.1 #> looic       325.8 9.3 #> ------ #> MCSE of elpd_loo is 0.0. #> MCSE and ESS estimates assume independent draws (r_eff=1). #>  #> All Pareto k estimates are good (k < 0.7). #> See help('pareto-k-diagnostic') for details. #>  #> --- Nonspecific --- #>  #> Computed from 2000 by 250 log-likelihood matrix. #>  #>          Estimate  SE #> elpd_loo   -163.6 4.7 #> p_loo         2.0 0.2 #> looic       327.2 9.3 #> ------ #> MCSE of elpd_loo is 0.0. #> MCSE and ESS estimates assume independent draws (r_eff=1). #>  #> All Pareto k estimates are good (k < 0.7). #> See help('pareto-k-diagnostic') for details."},{"path":"https://seroanalytics.org/seroCOP/articles/multi-biomarker.html","id":"conclusion","dir":"Articles","previous_headings":"","what":"Conclusion","title":"Multi-Biomarker Analysis with seroCOP","text":"analysis demonstrates: ✅ Multi-biomarker fitting: Successfully fitted models 3 biomarkers ✅ Performance comparison: Identified IgG best predictor ✅ Parameter recovery: Recovered true parameters uncertainty ✅ Visualization: Clear comparison plots decision-making","code":""},{"path":"https://seroanalytics.org/seroCOP/articles/multi-biomarker.html","id":"key-findings","dir":"Articles","previous_headings":"Conclusion","what":"Key Findings","title":"Multi-Biomarker Analysis with seroCOP","text":"IgG shows strong correlate protection (AUC > 0.85) IgA shows weak correlate protection (AUC ~ 0.65-0.75) Nonspecific shows correlate protection (AUC ~ 0.50) SeroCOPMulti class enables efficient comparison multiple biomarkers identify best correlates protection.","code":""},{"path":"https://seroanalytics.org/seroCOP/articles/multi-biomarker.html","id":"session-info","dir":"Articles","previous_headings":"Conclusion","what":"Session Info","title":"Multi-Biomarker Analysis with seroCOP","text":"","code":"sessionInfo() #> R version 4.5.2 (2025-10-31) #> Platform: x86_64-pc-linux-gnu #> Running under: Ubuntu 24.04.3 LTS #>  #> Matrix products: default #> BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  #> LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0 #>  #> locale: #>  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        #>  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    #>  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           #> [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    #>  #> time zone: UTC #> tzcode source: system (glibc) #>  #> attached base packages: #> [1] stats     graphics  grDevices utils     datasets  methods   base      #>  #> other attached packages: #> [1] ggplot2_4.0.0 seroCOP_0.1.0 #>  #> loaded via a namespace (and not attached): #>  [1] sass_0.4.10           generics_0.1.4        pROC_1.19.0.1         #>  [4] digest_0.6.38         magrittr_2.0.4        evaluate_1.0.5        #>  [7] grid_4.5.2            RColorBrewer_1.1-3    fastmap_1.2.0         #> [10] jsonlite_2.0.0        processx_3.8.6        pkgbuild_1.4.8        #> [13] ps_1.9.1              gridExtra_2.3         QuickJSR_1.8.1        #> [16] scales_1.4.0          codetools_0.2-20      textshaping_1.0.4     #> [19] jquerylib_0.1.4       cli_3.6.5             rlang_1.1.6           #> [22] withr_3.0.2           cachem_1.1.0          yaml_2.3.10           #> [25] StanHeaders_2.32.10   tools_4.5.2           rstan_2.32.7          #> [28] inline_0.3.21         parallel_4.5.2        dplyr_1.1.4           #> [31] vctrs_0.6.5           R6_2.6.1              matrixStats_1.5.0     #> [34] stats4_4.5.2          lifecycle_1.0.4       fs_1.6.6              #> [37] ragg_1.5.0            pkgconfig_2.0.3       desc_1.4.3            #> [40] callr_3.7.6           pkgdown_2.2.0         RcppParallel_5.1.11-1 #> [43] pillar_1.11.1         bslib_0.9.0           gtable_0.3.6          #> [46] loo_2.8.0             glue_1.8.0            Rcpp_1.1.0            #> [49] systemfonts_1.3.1     xfun_0.54             tibble_3.3.0          #> [52] tidyselect_1.2.1      knitr_1.50            farver_2.1.2          #> [55] htmltools_0.5.8.1     rmarkdown_2.30        labeling_0.4.3        #> [58] compiler_4.5.2        S7_0.2.0"},{"path":"https://seroanalytics.org/seroCOP/articles/serocop-overview.html","id":"overview-of-serocop","dir":"Articles","previous_headings":"","what":"Overview of SeroCOP","title":"SeroCOP Overview","text":"vignette provides comprehensive overview SeroCOP R6 class, including options, functions, usage. SeroCOP class designed Bayesian analysis correlates protection using Stan.","code":""},{"path":"https://seroanalytics.org/seroCOP/articles/serocop-overview.html","id":"key-features","dir":"Articles","previous_headings":"Overview of SeroCOP","what":"Key Features","title":"SeroCOP Overview","text":"Flexible prior distributions. Multi-biomarker analysis. Model fitting parameter extraction. Visualization tools.","code":""},{"path":"https://seroanalytics.org/seroCOP/articles/serocop-overview.html","id":"model-description","dir":"Articles","previous_headings":"Overview of SeroCOP","what":"Model Description","title":"SeroCOP Overview","text":"SeroCOP model based logistic regression framework, models probability protection function biomarker levels. logistic function defined : P(Y=1|X)=11+exp(−z), P(Y = 1 | X) = \\frac{1}{1 + \\exp(-z)}, zz linear combination predictors: z=β0+β1X1+β2X2+…+βkXk. z = \\beta_0 + \\beta_1 X_1 + \\beta_2 X_2 + \\dots + \\beta_k X_k.","code":""},{"path":"https://seroanalytics.org/seroCOP/articles/serocop-overview.html","id":"parameters","dir":"Articles","previous_headings":"Overview of SeroCOP > Model Description","what":"Parameters","title":"SeroCOP Overview","text":"β0\\beta_0: Intercept term. β1,β2,…,βk\\beta_1, \\beta_2, \\dots, \\beta_k: Coefficients predictors. X1,X2,…,XkX_1, X_2, \\dots, X_k: Biomarker levels.","code":""},{"path":"https://seroanalytics.org/seroCOP/articles/serocop-overview.html","id":"priors","dir":"Articles","previous_headings":"Overview of SeroCOP > Model Description","what":"Priors","title":"SeroCOP Overview","text":"SeroCOP model allows specify prior distributions parameters. priors can tailored reflect prior knowledge assumptions parameters.","code":""},{"path":"https://seroanalytics.org/seroCOP/articles/serocop-overview.html","id":"supported-priors","dir":"Articles","previous_headings":"Overview of SeroCOP > Model Description > Priors","what":"Supported Priors","title":"SeroCOP Overview","text":"Normal: Suitable parameters symmetric distributions. Uniform: Suitable parameters bounded ranges. Beta: Suitable probabilities proportions.","code":"model$definePrior(parameter = \"beta_1\", distribution = \"normal\", mean = 0, sd = 1) model$definePrior(parameter = \"beta_2\", distribution = \"uniform\", min = -1, max = 1) model$definePrior(parameter = \"p\", distribution = \"beta\", alpha = 2, beta = 5)"},{"path":"https://seroanalytics.org/seroCOP/articles/serocop-overview.html","id":"initialization","dir":"Articles","previous_headings":"Overview of SeroCOP","what":"Initialization","title":"SeroCOP Overview","text":"create new SeroCOP object, use following:","code":"library(seroCOP) # Example data set.seed(123) n <- 200 titre <- rnorm(n, mean = 2, sd = 1.5) prob <- 0.05 + 0.9 / (1 + exp(2 * (titre - 1.5))) infected <- rbinom(n, 1, prob)  # Initialize the model model <- SeroCOP$new(titre = titre, infected = infected)"},{"path":"https://seroanalytics.org/seroCOP/articles/serocop-overview.html","id":"arguments","dir":"Articles","previous_headings":"Overview of SeroCOP > Initialization","what":"Arguments","title":"SeroCOP Overview","text":"titre: Numeric vector antibody titres. infected: Binary vector (0/1) infection outcomes. inputs required initialize SeroCOP object.","code":""},{"path":"https://seroanalytics.org/seroCOP/articles/serocop-overview.html","id":"prior-options","dir":"Articles","previous_headings":"Overview of SeroCOP","what":"Prior Options","title":"SeroCOP Overview","text":"definePrior method allows specify prior distributions model parameters. detailed explanation option: floor_alpha: Alpha parameter Beta prior distribution “floor” parameter. Default: 1. floor_beta: Beta parameter Beta prior distribution “floor” parameter. Default: 9. ceiling_alpha: Alpha parameter Beta prior distribution “ceiling” parameter. Default: 9. ceiling_beta: Beta parameter Beta prior distribution “ceiling” parameter. Default: 1. ec50_mean: Mean Normal prior distribution ec50 parameter. Default: Midpoint titre range. ec50_sd: Standard deviation Normal prior distribution ec50 parameter. Default: One-fourth titre range. slope_mean: Mean Normal prior distribution slope parameter. Default: 0. slope_sd: Standard deviation Normal prior distribution slope parameter. Default: 2.","code":""},{"path":"https://seroanalytics.org/seroCOP/articles/serocop-overview.html","id":"example-usage","dir":"Articles","previous_headings":"Overview of SeroCOP > Prior Options","what":"Example Usage","title":"SeroCOP Overview","text":"","code":"model$definePrior(   floor_alpha = 2, floor_beta = 18,    # Stronger prior for low floor   ceiling_alpha = 18, ceiling_beta = 2, # Stronger prior for high ceiling   ec50_mean = 1.5, ec50_sd = 0.5,      # Custom ec50 prior   slope_mean = 0, slope_sd = 1         # More conservative slope )"},{"path":"https://seroanalytics.org/seroCOP/articles/serocop-overview.html","id":"supported-distributions","dir":"Articles","previous_headings":"Overview of SeroCOP > Prior Options","what":"Supported Distributions","title":"SeroCOP Overview","text":"Normal Uniform Beta","code":""},{"path":"https://seroanalytics.org/seroCOP/articles/serocop-overview.html","id":"model-fitting","dir":"Articles","previous_headings":"Overview of SeroCOP","what":"Model Fitting","title":"SeroCOP Overview","text":"fit_model method fits model data using Stan. Example:","code":"fit <- model$fit_model(   chains = 4,   iter = 2000,   warmup = 500,   cores = 2 )"},{"path":"https://seroanalytics.org/seroCOP/articles/serocop-overview.html","id":"arguments-1","dir":"Articles","previous_headings":"Overview of SeroCOP > Model Fitting","what":"Arguments","title":"SeroCOP Overview","text":"data: dataset fit model . chains: Number MCMC chains. iter: Total number iterations per chain. warmup: Number warmup iterations. cores: Number CPU cores use.","code":""},{"path":"https://seroanalytics.org/seroCOP/articles/serocop-overview.html","id":"multi-biomarker-analysis","dir":"Articles","previous_headings":"Overview of SeroCOP","what":"Multi-Biomarker Analysis","title":"SeroCOP Overview","text":"SeroCOPMulti class extends SeroCOP support multi-biomarker analysis. Example:","code":"set.seed(123) data1 <- data.frame(   titre = rnorm(100, mean = 2, sd = 1.5),   infected = rbinom(100, 1, prob = 0.5) ) data2 <- data.frame(   titre = rnorm(100, mean = 3, sd = 1.2),   infected = rbinom(100, 1, prob = 0.6) )   multi_model <- SeroCOPMulti$new(   titre = c(data1$titre, data2$titre),   infected = c(data1$infected, data2$infected) ) multi_fit <- multi_model$fit_all(   chains = 4,   iter = 2000,   warmup = 500,   cores = 2 )"},{"path":[]},{"path":"https://seroanalytics.org/seroCOP/articles/serocop-overview.html","id":"visualization","dir":"Articles","previous_headings":"Overview of SeroCOP","what":"Visualization","title":"SeroCOP Overview","text":"plot method provides visualization tools fitted model:","code":"fit$plot_curve()"},{"path":"https://seroanalytics.org/seroCOP/articles/serocop-overview.html","id":"extracting-parameters","dir":"Articles","previous_headings":"Overview of SeroCOP","what":"Extracting Parameters","title":"SeroCOP Overview","text":"Use extract_parameters method extract posterior samples:","code":"params <- model$extract_parameters()"},{"path":"https://seroanalytics.org/seroCOP/articles/serocop-overview.html","id":"summary","dir":"Articles","previous_headings":"Overview of SeroCOP","what":"Summary","title":"SeroCOP Overview","text":"SeroCOP class provides flexible powerful framework Bayesian analysis correlates protection. vignette covered key options functions available class. details, refer package documentation.","code":""},{"path":"https://seroanalytics.org/seroCOP/articles/simulation-recovery.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Simulation and Recovery Analysis with seroCOP","text":"vignette demonstrates use seroCOP package analyze correlates protection using Bayesian methods. ’ll simulate data known four-parameter logistic model, fit model, validate can recover true parameters.","code":""},{"path":"https://seroanalytics.org/seroCOP/articles/simulation-recovery.html","id":"load-the-package","dir":"Articles","previous_headings":"Introduction","what":"Load the package","title":"Simulation and Recovery Analysis with seroCOP","text":"","code":"library(seroCOP) library(ggplot2)"},{"path":"https://seroanalytics.org/seroCOP/articles/simulation-recovery.html","id":"simulate-data","dir":"Articles","previous_headings":"","what":"Simulate Data","title":"Simulation and Recovery Analysis with seroCOP","text":"’ll simulate data probability infection follows four-parameter logistic curve function antibody titre. parameters ’ll use : floor = 0.05 (5% minimum infection probability) ceiling = 0.90 (90% maximum infection probability) ec50 = 1.5 (titre 50% infection probability) slope = 2.0 (steepness curve)","code":"# Set parameters for simulation set.seed(2025)  true_params <- list(   floor = 0.05,   ceiling = 0.90,   ec50 = 1.5,   slope = 2.0 )  # Simulate data sim_data <- simulate_serocop_data(   n = 300,   floor = true_params$floor,   ceiling = true_params$ceiling,   ec50 = true_params$ec50,   slope = true_params$slope,   titre_mean = 2.0,   titre_sd = 1.5,   seed = 2025 )  # Examine the simulated data cat(sprintf(\"Sample size: %d\\n\", length(sim_data$titre))) #> Sample size: 300 cat(sprintf(\"Infection rate: %.1f%%\\n\", mean(sim_data$infected) * 100)) #> Infection rate: 39.0% cat(sprintf(\"Titre range: [%.2f, %.2f]\\n\",              min(sim_data$titre), max(sim_data$titre))) #> Titre range: [-2.27, 6.28]"},{"path":"https://seroanalytics.org/seroCOP/articles/simulation-recovery.html","id":"visualize-the-simulated-data","dir":"Articles","previous_headings":"Simulate Data","what":"Visualize the Simulated Data","title":"Simulation and Recovery Analysis with seroCOP","text":"","code":"# Create a plot showing the true relationship plot_df <- data.frame(   titre = sim_data$titre,   infected = sim_data$infected,   prob_true = sim_data$prob_true )  ggplot(plot_df, aes(x = titre, y = prob_true)) +   geom_line(color = \"red\", linewidth = 1, alpha = 0.7) +   geom_point(aes(y = infected), alpha = 0.3) +   labs(     title = \"Simulated Data: True Infection Probability\",     x = \"Antibody Titre (log scale)\",     y = \"Probability of Infection\"   ) +   theme_minimal() +   theme(plot.title = element_text(hjust = 0.5, face = \"bold\"))"},{"path":"https://seroanalytics.org/seroCOP/articles/simulation-recovery.html","id":"fit-the-model","dir":"Articles","previous_headings":"","what":"Fit the Model","title":"Simulation and Recovery Analysis with seroCOP","text":"Now ’ll create SeroCOP object fit Bayesian model simulated data.","code":""},{"path":"https://seroanalytics.org/seroCOP/articles/simulation-recovery.html","id":"setting-priors","dir":"Articles","previous_headings":"Fit the Model","what":"Setting Priors","title":"Simulation and Recovery Analysis with seroCOP","text":"seroCOP package allows customize prior distributions. default: ec50 centered midpoint observed titre range ec50_sd set titre_range / 4 floor ~ Beta(1, 9) - weak prior favoring low infection high titres ceiling ~ Beta(9, 1) - weak prior favoring high infection low titres slope ~ Normal(0, 2) - weakly informative, truncated 0 can customize priors prior knowledge:","code":"# Initialize SeroCOP object model <- SeroCOP$new(   titre = sim_data$titre,   infected = sim_data$infected ) #> SeroCOP initialized with 300 observations #>   Infection rate: 39.0% #>   Titre range: [-2.27, 6.28]  # View default priors (automatically set based on data) cat(\"Default priors:\\n\") #> Default priors: print(model$priors) #> $floor_alpha #> [1] 1 #>  #> $floor_beta #> [1] 9 #>  #> $ceiling_alpha #> [1] 9 #>  #> $ceiling_beta #> [1] 1 #>  #> $ec50_mean #> [1] 2.002654 #>  #> $ec50_sd #> [1] 2.138259 #>  #> $slope_mean #> [1] 0 #>  #> $slope_sd #> [1] 2 # Example: Set custom priors (not run in this vignette) model$definePrior(   floor_alpha = 2, floor_beta = 18,      # Stronger prior: E[floor] ≈ 0.1   ceiling_alpha = 18, ceiling_beta = 2,  # Stronger prior: E[ceiling] ≈ 0.9   ec50_mean = 2.0, ec50_sd = 1.0,        # Informative prior on ec50   slope_mean = 0, slope_sd = 1           # More conservative slope )"},{"path":"https://seroanalytics.org/seroCOP/articles/simulation-recovery.html","id":"fitting-the-model","dir":"Articles","previous_headings":"Fit the Model","what":"Fitting the Model","title":"Simulation and Recovery Analysis with seroCOP","text":"","code":"# Fit the model (using default data-driven priors) # Note: Using fewer iterations for vignette speed;  # use more (e.g., iter=2000) for real analysis model$fit_model(   chains = 4,   iter = 1000,   warmup = 500,   cores = 1  # Adjust based on your system ) #> Warning: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#bulk-ess #> Warning: Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#tail-ess"},{"path":[]},{"path":"https://seroanalytics.org/seroCOP/articles/simulation-recovery.html","id":"parameter-summary","dir":"Articles","previous_headings":"Model Diagnostics","what":"Parameter Summary","title":"Simulation and Recovery Analysis with seroCOP","text":"Let’s examine posterior distributions parameters compare true values:","code":"# Get parameter summary param_est <- extract_parameters(model, prob = 0.95) print(param_est) #>   parameter       mean     median      lower     upper #> 1     floor 0.09642708 0.09786847 0.02485813 0.1676064 #> 2   ceiling 0.88623967 0.88434593 0.77492731 0.9929769 #> 3      ec50 1.45779155 1.46501599 1.13277387 1.7373545 #> 4     slope 2.58401348 2.44805019 1.19778888 4.7727179  # Compare to true values cat(\"\\nTrue Parameters:\\n\") #>  #> True Parameters: cat(sprintf(\"  floor:   %.3f\\n\", true_params$floor)) #>   floor:   0.050 cat(sprintf(\"  ceiling: %.3f\\n\", true_params$ceiling)) #>   ceiling: 0.900 cat(sprintf(\"  ec50:    %.3f\\n\", true_params$ec50)) #>   ec50:    1.500 cat(sprintf(\"  slope:   %.3f\\n\", true_params$slope)) #>   slope:   2.000"},{"path":"https://seroanalytics.org/seroCOP/articles/simulation-recovery.html","id":"parameter-recovery","dir":"Articles","previous_headings":"Model Diagnostics","what":"Parameter Recovery","title":"Simulation and Recovery Analysis with seroCOP","text":"Let’s visualize well recovered true parameters:","code":"# Create comparison plot recovery_df <- data.frame(   parameter = param_est$parameter,   estimated = param_est$mean,   lower = param_est$lower,   upper = param_est$upper,   true = c(true_params$floor, true_params$ceiling,             true_params$ec50, true_params$slope) )  ggplot(recovery_df, aes(x = parameter)) +   geom_pointrange(aes(y = estimated, ymin = lower, ymax = upper),                   color = \"steelblue\", size = 1) +   geom_point(aes(y = true), color = \"red\", size = 3, shape = 4) +   labs(     title = \"Parameter Recovery\",     subtitle = \"Blue: Estimated (95% CI) | Red X: True Value\",     x = \"Parameter\",     y = \"Value\"   ) +   theme_minimal() +   theme(plot.title = element_text(hjust = 0.5, face = \"bold\"),         plot.subtitle = element_text(hjust = 0.5))"},{"path":"https://seroanalytics.org/seroCOP/articles/simulation-recovery.html","id":"performance-metrics","dir":"Articles","previous_headings":"","what":"Performance Metrics","title":"Simulation and Recovery Analysis with seroCOP","text":"Now let’s evaluate model’s predictive performance: model shows good performance: ROC AUC: 0.839 (closer 1 better) Brier Score: 0.150 (closer 0 better) LOO ELPD: -145.51 (higher better)","code":"# Get performance metrics metrics <- model$get_metrics() #> Performance Metrics: #>   ROC AUC: 0.839 #>   Brier Score: 0.150 #>   LOO ELPD: -145.51 (SE: 9.96)"},{"path":[]},{"path":"https://seroanalytics.org/seroCOP/articles/simulation-recovery.html","id":"fitted-curve","dir":"Articles","previous_headings":"Visualization","what":"Fitted Curve","title":"Simulation and Recovery Analysis with seroCOP","text":"plot shows: Blue line: Posterior mean prediction Blue ribbon: 95% credible interval Points: Observed infection outcomes (jittered visibility)","code":"model$plot_curve()"},{"path":"https://seroanalytics.org/seroCOP/articles/simulation-recovery.html","id":"roc-curve","dir":"Articles","previous_headings":"Visualization","what":"ROC Curve","title":"Simulation and Recovery Analysis with seroCOP","text":"","code":"model$plot_roc()"},{"path":"https://seroanalytics.org/seroCOP/articles/simulation-recovery.html","id":"posterior-predictive-checks","dir":"Articles","previous_headings":"","what":"Posterior Predictive Checks","title":"Simulation and Recovery Analysis with seroCOP","text":"Let’s examine posterior predictive distribution:","code":"# Get predictions predictions <- model$predict()  # Calculate prediction intervals pred_mean <- colMeans(predictions) pred_lower <- apply(predictions, 2, quantile, probs = 0.025) pred_upper <- apply(predictions, 2, quantile, probs = 0.975)  # Plot calibration calib_df <- data.frame(   observed = sim_data$infected,   predicted = pred_mean,   titre = sim_data$titre )  # Binned calibration plot breaks <- quantile(calib_df$titre, probs = seq(0, 1, 0.1)) calib_df$bin <- cut(calib_df$titre, breaks = breaks, include.lowest = TRUE)  calib_summary <- aggregate(   cbind(observed, predicted) ~ bin,   data = calib_df,   FUN = mean )  ggplot(calib_summary, aes(x = predicted, y = observed)) +   geom_point(size = 3, color = \"steelblue\") +   geom_abline(slope = 1, intercept = 0, linetype = \"dashed\") +   labs(     title = \"Calibration Plot\",     x = \"Predicted Probability\",     y = \"Observed Proportion\"   ) +   theme_minimal() +   theme(plot.title = element_text(hjust = 0.5, face = \"bold\")) +   coord_equal(xlim = c(0, 1), ylim = c(0, 1))"},{"path":"https://seroanalytics.org/seroCOP/articles/simulation-recovery.html","id":"cross-validation","dir":"Articles","previous_headings":"","what":"Cross-Validation","title":"Simulation and Recovery Analysis with seroCOP","text":"Leave-One-Cross-Validation (LOO-CV) provides estimate --sample predictive performance: Key LOO metrics: elpd_loo: Expected log pointwise predictive density p_loo: Effective number parameters looic: LOO information criterion (lower better)","code":"# Print LOO details print(model$loo) #>  #> Computed from 2000 by 300 log-likelihood matrix. #>  #>          Estimate   SE #> elpd_loo   -145.5 10.0 #> p_loo         3.9  0.4 #> looic       291.0 19.9 #> ------ #> MCSE of elpd_loo is 0.0. #> MCSE and ESS estimates assume independent draws (r_eff=1). #>  #> All Pareto k estimates are good (k < 0.7). #> See help('pareto-k-diagnostic') for details."},{"path":"https://seroanalytics.org/seroCOP/articles/simulation-recovery.html","id":"conclusion","dir":"Articles","previous_headings":"","what":"Conclusion","title":"Simulation and Recovery Analysis with seroCOP","text":"vignette demonstrated: ✅ Simulating data four-parameter logistic model ✅ Fitting Bayesian model using SeroCOP R6 class ✅ Recovering true parameter values credible intervals ✅ Calculating performance metrics (ROC AUC, Brier score, LOO-CV) ✅ Visualizing results diagnostic plots seroCOP package provides complete workflow correlates protection analysis proper uncertainty quantification Bayesian inference.","code":""},{"path":"https://seroanalytics.org/seroCOP/articles/simulation-recovery.html","id":"session-info","dir":"Articles","previous_headings":"Conclusion","what":"Session Info","title":"Simulation and Recovery Analysis with seroCOP","text":"","code":"sessionInfo() #> R version 4.5.2 (2025-10-31) #> Platform: x86_64-pc-linux-gnu #> Running under: Ubuntu 24.04.3 LTS #>  #> Matrix products: default #> BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  #> LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0 #>  #> locale: #>  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        #>  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    #>  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           #> [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    #>  #> time zone: UTC #> tzcode source: system (glibc) #>  #> attached base packages: #> [1] stats     graphics  grDevices utils     datasets  methods   base      #>  #> other attached packages: #> [1] ggplot2_4.0.0 seroCOP_0.1.0 #>  #> loaded via a namespace (and not attached): #>  [1] sass_0.4.10           generics_0.1.4        pROC_1.19.0.1         #>  [4] digest_0.6.38         magrittr_2.0.4        evaluate_1.0.5        #>  [7] grid_4.5.2            RColorBrewer_1.1-3    fastmap_1.2.0         #> [10] jsonlite_2.0.0        processx_3.8.6        pkgbuild_1.4.8        #> [13] ps_1.9.1              gridExtra_2.3         QuickJSR_1.8.1        #> [16] scales_1.4.0          codetools_0.2-20      textshaping_1.0.4     #> [19] jquerylib_0.1.4       cli_3.6.5             rlang_1.1.6           #> [22] withr_3.0.2           cachem_1.1.0          yaml_2.3.10           #> [25] StanHeaders_2.32.10   tools_4.5.2           rstan_2.32.7          #> [28] inline_0.3.21         parallel_4.5.2        dplyr_1.1.4           #> [31] vctrs_0.6.5           R6_2.6.1              matrixStats_1.5.0     #> [34] stats4_4.5.2          lifecycle_1.0.4       fs_1.6.6              #> [37] ragg_1.5.0            pkgconfig_2.0.3       desc_1.4.3            #> [40] callr_3.7.6           pkgdown_2.2.0         RcppParallel_5.1.11-1 #> [43] pillar_1.11.1         bslib_0.9.0           gtable_0.3.6          #> [46] loo_2.8.0             glue_1.8.0            Rcpp_1.1.0            #> [49] systemfonts_1.3.1     xfun_0.54             tibble_3.3.0          #> [52] tidyselect_1.2.1      knitr_1.50            farver_2.1.2          #> [55] htmltools_0.5.8.1     rmarkdown_2.30        labeling_0.4.3        #> [58] compiler_4.5.2        S7_0.2.0"},{"path":"https://seroanalytics.org/seroCOP/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"David Hodgson. Author, maintainer.","code":""},{"path":"https://seroanalytics.org/seroCOP/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Hodgson D (2025). seroCOP: Correlates Protection Analysis Using Bayesian Methods. R package version 0.1.0, https://seroanalytics.org/seroCOP/.","code":"@Manual{,   title = {seroCOP: Correlates of Protection Analysis Using Bayesian Methods},   author = {David Hodgson},   year = {2025},   note = {R package version 0.1.0},   url = {https://seroanalytics.org/seroCOP/}, }"},{"path":"https://seroanalytics.org/seroCOP/index.html","id":"serocop","dir":"","previous_headings":"","what":"seroCOP - Correlates of Protection Analysis","title":"seroCOP - Correlates of Protection Analysis","text":"seroCOP R package analysing correlates protection using Bayesian methods. fits generalized four-parameter logistic functions antibody titre infection outcome data using Stan, providing comprehensive model diagnostics performance metrics.","code":""},{"path":"https://seroanalytics.org/seroCOP/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"seroCOP - Correlates of Protection Analysis","text":"can install development version seroCOP GitHub: Note: package requires working installation RStan. See RStan Getting Started installation instructions.","code":"# Install devtools if needed install.packages(\"devtools\")  # Install seroCOP devtools::install_github(\"seroanalytics/seroCOP\")"},{"path":"https://seroanalytics.org/seroCOP/index.html","id":"quick-start","dir":"","previous_headings":"","what":"Quick Start","title":"seroCOP - Correlates of Protection Analysis","text":"","code":"library(seroCOP)  # Simulate data sim_data <- simulate_serocop_data(   n = 200,   floor = 0.05,   ceiling = 0.90,   ec50 = 1.5,   slope = 2.0,   seed = 123 )  # Create SeroCOP object model <- SeroCOP$new(   titre = sim_data$titre,   infected = sim_data$infected )  # Optional: Customize priors (defaults are data-driven) model$definePrior(   floor_alpha = 2, floor_beta = 18,    # E[floor] ≈ 0.1   ec50_mean = 2.0, ec50_sd = 1.0       # Informative prior on ec50 )  # Fit the model model$fit_model(chains = 4, iter = 2000)  # Get performance metrics model$get_metrics()  # Visualize results model$plot_curve() model$plot_roc()  # Extract parameter estimates extract_parameters(model)"},{"path":"https://seroanalytics.org/seroCOP/index.html","id":"multi-biomarker-analysis","dir":"","previous_headings":"","what":"Multi-Biomarker Analysis","title":"seroCOP - Correlates of Protection Analysis","text":"Compare multiple biomarkers simultaneously:","code":"# Prepare multi-biomarker data (matrix with columns = biomarkers) titre_matrix <- cbind(   IgG = rnorm(200, 2, 1),   IgA = rnorm(200, 1.5, 1),   Neutralization = rnorm(200, 3, 1.2) )  # Initialize and fit multi_model <- SeroCOPMulti$new(   titre = titre_matrix,   infected = infected ) multi_model$fit_all(chains = 4, iter = 2000)  # Compare biomarkers multi_model$compare_biomarkers() multi_model$plot_comparison()  # AUC vs LOO-ELPD plot multi_model$plot_all_curves()"},{"path":"https://seroanalytics.org/seroCOP/index.html","id":"flexible-prior-distributions","dir":"","previous_headings":"","what":"Flexible Prior Distributions","title":"seroCOP - Correlates of Protection Analysis","text":"package automatically sets sensible default priors based data: ec50 centered midpoint observed titre range floor ceiling weak priors favoring low/high infection probabilities can easily customize priors using definePrior() method:","code":"model$definePrior(   floor_alpha = 2, floor_beta = 18,      # Beta prior for floor   ceiling_alpha = 18, ceiling_beta = 2,  # Beta prior for ceiling   ec50_mean = 2.0, ec50_sd = 1.0,        # Normal prior for ec50   slope_mean = 0, slope_sd = 2           # Normal prior for slope (truncated at 0) )"},{"path":"https://seroanalytics.org/seroCOP/index.html","id":"model","dir":"","previous_headings":"","what":"Model","title":"seroCOP - Correlates of Protection Analysis","text":"package fits four-parameter logistic model: P(infection|titre)=floor+ceiling−floor1+eslope×(titre−ec50)P(\\text{infection} | \\text{titre}) = \\text{floor} + \\frac{\\text{ceiling} - \\text{floor}}{1 + e^{\\text{slope} \\times (\\text{titre} - \\text{ec50})}} : - floor: Lower asymptote (minimum infection probability) - ceiling: Upper asymptote (maximum infection probability) - ec50: Titre 50% floor ceiling (inflection point) - slope: Steepness curve","code":""},{"path":"https://seroanalytics.org/seroCOP/index.html","id":"documentation","dir":"","previous_headings":"","what":"Documentation","title":"seroCOP - Correlates of Protection Analysis","text":"See package vignettes detailed examples:","code":"# View available vignettes browseVignettes(\"seroCOP\")"},{"path":"https://seroanalytics.org/seroCOP/index.html","id":"performance-metrics","dir":"","previous_headings":"","what":"Performance Metrics","title":"seroCOP - Correlates of Protection Analysis","text":"package calculates several performance metrics: ROC AUC: Area ROC curve (discrimination) Brier Score: Mean squared error predictions (calibration) LOO-CV: Leave-one-cross-validation (--sample performance) ELPD: Expected log pointwise predictive density","code":""},{"path":"https://seroanalytics.org/seroCOP/index.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"seroCOP - Correlates of Protection Analysis","text":"use package research, please cite:","code":"Hodgson, D. (2025). seroCOP: Correlates of Protection Analysis Using Bayesian Methods. R package version 0.1.0."},{"path":"https://seroanalytics.org/seroCOP/index.html","id":"development","dir":"","previous_headings":"","what":"Development","title":"seroCOP - Correlates of Protection Analysis","text":"package active development. Contributions feedback welcome.","code":""},{"path":"https://seroanalytics.org/seroCOP/index.html","id":"support","dir":"","previous_headings":"","what":"Support","title":"seroCOP - Correlates of Protection Analysis","text":"questions, issues, feature requests, please open issue GitHub.","code":""},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOP.html","id":null,"dir":"Reference","previous_headings":"","what":"SeroCOP R6 Class for Correlates of Protection Analysis — SeroCOP","title":"SeroCOP R6 Class for Correlates of Protection Analysis — SeroCOP","text":"R6 class analyzing correlates protection using Bayesian methods. Fits four-parameter logistic model antibody titre infection outcome data.","code":""},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOP.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"SeroCOP R6 Class for Correlates of Protection Analysis — SeroCOP","text":"class provides complete workflow correlates protection analysis: Data input validation Bayesian model fitting using Stan Model diagnostics validation Performance metrics (ROC AUC, Brier score, LOO-CV) Visualization","code":""},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOP.html","id":"public-fields","dir":"Reference","previous_headings":"","what":"Public fields","title":"SeroCOP R6 Class for Correlates of Protection Analysis — SeroCOP","text":"titre Numeric vector antibody titres (log scale recommended) infected Binary vector infection status (0/1) fit Stan fit object (fitting) loo LOO-CV object (fitting) priors List prior distributions model parameters","code":""},{"path":[]},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOP.html","id":"public-methods","dir":"Reference","previous_headings":"","what":"Public methods","title":"SeroCOP R6 Class for Correlates of Protection Analysis — SeroCOP","text":"SeroCOP$new() SeroCOP$definePrior() SeroCOP$fit_model() SeroCOP$predict() SeroCOP$summary() SeroCOP$get_metrics() SeroCOP$plot_curve() SeroCOP$plot_roc() SeroCOP$plot_parameters() SeroCOP$clone()","code":""},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOP.html","id":"method-new-","dir":"Reference","previous_headings":"","what":"Method new()","title":"SeroCOP R6 Class for Correlates of Protection Analysis — SeroCOP","text":"Create new SeroCOP object","code":""},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOP.html","id":"usage","dir":"Reference","previous_headings":"","what":"Usage","title":"SeroCOP R6 Class for Correlates of Protection Analysis — SeroCOP","text":"","code":"SeroCOP$new(titre, infected)"},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOP.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"SeroCOP R6 Class for Correlates of Protection Analysis — SeroCOP","text":"titre Numeric vector antibody titres infected Binary vector (0/1) infection outcomes","code":""},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOP.html","id":"returns","dir":"Reference","previous_headings":"","what":"Returns","title":"SeroCOP R6 Class for Correlates of Protection Analysis — SeroCOP","text":"new SeroCOP object","code":""},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOP.html","id":"method-defineprior-","dir":"Reference","previous_headings":"","what":"Method definePrior()","title":"SeroCOP R6 Class for Correlates of Protection Analysis — SeroCOP","text":"Define custom prior distributions model parameters","code":""},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOP.html","id":"usage-1","dir":"Reference","previous_headings":"","what":"Usage","title":"SeroCOP R6 Class for Correlates of Protection Analysis — SeroCOP","text":"","code":"SeroCOP$definePrior(   floor_alpha = NULL,   floor_beta = NULL,   ceiling_alpha = NULL,   ceiling_beta = NULL,   ec50_mean = NULL,   ec50_sd = NULL,   slope_mean = NULL,   slope_sd = NULL )"},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOP.html","id":"arguments-1","dir":"Reference","previous_headings":"","what":"Arguments","title":"SeroCOP R6 Class for Correlates of Protection Analysis — SeroCOP","text":"floor_alpha Alpha parameter floor beta prior (default: 1) floor_beta Beta parameter floor beta prior (default: 9) ceiling_alpha Alpha parameter ceiling beta prior (default: 9) ceiling_beta Beta parameter ceiling beta prior (default: 1) ec50_mean Mean ec50 normal prior (default: midpoint titre range) ec50_sd SD ec50 normal prior (default: titre range / 4) slope_mean Mean slope normal prior (default: 0) slope_sd SD slope normal prior (default: 2)","code":""},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOP.html","id":"returns-1","dir":"Reference","previous_headings":"","what":"Returns","title":"SeroCOP R6 Class for Correlates of Protection Analysis — SeroCOP","text":"Self (invisibly)","code":""},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOP.html","id":"examples","dir":"Reference","previous_headings":"","what":"Examples","title":"SeroCOP R6 Class for Correlates of Protection Analysis — SeroCOP","text":"","code":"\\dontrun{ model <- SeroCOP$new(titre = titre, infected = infected)  # Use default priors centered on data model$definePrior()  # Custom priors model$definePrior(   floor_alpha = 2, floor_beta = 18,    # Stronger prior for low floor   ceiling_alpha = 18, ceiling_beta = 2, # Stronger prior for high ceiling   ec50_mean = 2.0, ec50_sd = 1.0,      # Custom ec50 prior   slope_mean = 0, slope_sd = 1         # More conservative slope ) }"},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOP.html","id":"method-fit-model-","dir":"Reference","previous_headings":"","what":"Method fit_model()","title":"SeroCOP R6 Class for Correlates of Protection Analysis — SeroCOP","text":"Fit Bayesian logistic model","code":""},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOP.html","id":"usage-2","dir":"Reference","previous_headings":"","what":"Usage","title":"SeroCOP R6 Class for Correlates of Protection Analysis — SeroCOP","text":"","code":"SeroCOP$fit_model(   chains = 4,   iter = 2000,   warmup = floor(iter/2),   thin = 1,   ... )"},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOP.html","id":"arguments-2","dir":"Reference","previous_headings":"","what":"Arguments","title":"SeroCOP R6 Class for Correlates of Protection Analysis — SeroCOP","text":"chains Number MCMC chains (default: 4) iter Number iterations per chain (default: 2000) warmup Number warmup iterations (default: iter/2) thin Thinning interval (default: 1) ... Additional arguments passed rstan::sampling","code":""},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOP.html","id":"returns-2","dir":"Reference","previous_headings":"","what":"Returns","title":"SeroCOP R6 Class for Correlates of Protection Analysis — SeroCOP","text":"Self (invisibly)","code":""},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOP.html","id":"method-predict-","dir":"Reference","previous_headings":"","what":"Method predict()","title":"SeroCOP R6 Class for Correlates of Protection Analysis — SeroCOP","text":"Get posterior predictions infection probability","code":""},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOP.html","id":"usage-3","dir":"Reference","previous_headings":"","what":"Usage","title":"SeroCOP R6 Class for Correlates of Protection Analysis — SeroCOP","text":"","code":"SeroCOP$predict(newdata = NULL)"},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOP.html","id":"arguments-3","dir":"Reference","previous_headings":"","what":"Arguments","title":"SeroCOP R6 Class for Correlates of Protection Analysis — SeroCOP","text":"newdata Optional new titre values prediction","code":""},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOP.html","id":"returns-3","dir":"Reference","previous_headings":"","what":"Returns","title":"SeroCOP R6 Class for Correlates of Protection Analysis — SeroCOP","text":"Matrix posterior predictions (iterations x observations)","code":""},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOP.html","id":"method-summary-","dir":"Reference","previous_headings":"","what":"Method summary()","title":"SeroCOP R6 Class for Correlates of Protection Analysis — SeroCOP","text":"Get summary statistics model parameters","code":""},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOP.html","id":"usage-4","dir":"Reference","previous_headings":"","what":"Usage","title":"SeroCOP R6 Class for Correlates of Protection Analysis — SeroCOP","text":"","code":"SeroCOP$summary()"},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOP.html","id":"returns-4","dir":"Reference","previous_headings":"","what":"Returns","title":"SeroCOP R6 Class for Correlates of Protection Analysis — SeroCOP","text":"Data frame parameter summaries","code":""},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOP.html","id":"method-get-metrics-","dir":"Reference","previous_headings":"","what":"Method get_metrics()","title":"SeroCOP R6 Class for Correlates of Protection Analysis — SeroCOP","text":"Calculate performance metrics","code":""},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOP.html","id":"usage-5","dir":"Reference","previous_headings":"","what":"Usage","title":"SeroCOP R6 Class for Correlates of Protection Analysis — SeroCOP","text":"","code":"SeroCOP$get_metrics()"},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOP.html","id":"returns-5","dir":"Reference","previous_headings":"","what":"Returns","title":"SeroCOP R6 Class for Correlates of Protection Analysis — SeroCOP","text":"List containing ROC AUC, Brier score, LOO-CV metrics","code":""},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOP.html","id":"method-plot-curve-","dir":"Reference","previous_headings":"","what":"Method plot_curve()","title":"SeroCOP R6 Class for Correlates of Protection Analysis — SeroCOP","text":"Plot fitted curve uncertainty","code":""},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOP.html","id":"usage-6","dir":"Reference","previous_headings":"","what":"Usage","title":"SeroCOP R6 Class for Correlates of Protection Analysis — SeroCOP","text":"","code":"SeroCOP$plot_curve(title = \"Correlates of Risk Curve\", ...)"},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOP.html","id":"arguments-4","dir":"Reference","previous_headings":"","what":"Arguments","title":"SeroCOP R6 Class for Correlates of Protection Analysis — SeroCOP","text":"title Plot title ... Additional arguments passed ggplot2","code":""},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOP.html","id":"returns-6","dir":"Reference","previous_headings":"","what":"Returns","title":"SeroCOP R6 Class for Correlates of Protection Analysis — SeroCOP","text":"ggplot object","code":""},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOP.html","id":"method-plot-roc-","dir":"Reference","previous_headings":"","what":"Method plot_roc()","title":"SeroCOP R6 Class for Correlates of Protection Analysis — SeroCOP","text":"Plot ROC curve","code":""},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOP.html","id":"usage-7","dir":"Reference","previous_headings":"","what":"Usage","title":"SeroCOP R6 Class for Correlates of Protection Analysis — SeroCOP","text":"","code":"SeroCOP$plot_roc(title = \"ROC Curve\")"},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOP.html","id":"arguments-5","dir":"Reference","previous_headings":"","what":"Arguments","title":"SeroCOP R6 Class for Correlates of Protection Analysis — SeroCOP","text":"title Plot title","code":""},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOP.html","id":"returns-7","dir":"Reference","previous_headings":"","what":"Returns","title":"SeroCOP R6 Class for Correlates of Protection Analysis — SeroCOP","text":"ggplot object","code":""},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOP.html","id":"method-plot-parameters-","dir":"Reference","previous_headings":"","what":"Method plot_parameters()","title":"SeroCOP R6 Class for Correlates of Protection Analysis — SeroCOP","text":"Plot posterior distributions parameters","code":""},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOP.html","id":"usage-8","dir":"Reference","previous_headings":"","what":"Usage","title":"SeroCOP R6 Class for Correlates of Protection Analysis — SeroCOP","text":"","code":"SeroCOP$plot_parameters()"},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOP.html","id":"returns-8","dir":"Reference","previous_headings":"","what":"Returns","title":"SeroCOP R6 Class for Correlates of Protection Analysis — SeroCOP","text":"ggplot object","code":""},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOP.html","id":"method-clone-","dir":"Reference","previous_headings":"","what":"Method clone()","title":"SeroCOP R6 Class for Correlates of Protection Analysis — SeroCOP","text":"objects class cloneable method.","code":""},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOP.html","id":"usage-9","dir":"Reference","previous_headings":"","what":"Usage","title":"SeroCOP R6 Class for Correlates of Protection Analysis — SeroCOP","text":"","code":"SeroCOP$clone(deep = FALSE)"},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOP.html","id":"arguments-6","dir":"Reference","previous_headings":"","what":"Arguments","title":"SeroCOP R6 Class for Correlates of Protection Analysis — SeroCOP","text":"deep Whether make deep clone.","code":""},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOP.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"SeroCOP R6 Class for Correlates of Protection Analysis — SeroCOP","text":"","code":"if (FALSE) { # \\dontrun{ # Create synthetic data set.seed(123) n <- 200 titre <- rnorm(n, mean = 2, sd = 1.5) prob <- 0.05 + 0.9 / (1 + exp(2 * (titre - 1.5))) infected <- rbinom(n, 1, prob)  # Initialize and fit model <- SeroCOP$new(titre = titre, infected = infected) model$fit(chains = 4, iter = 2000)  # Get metrics model$get_metrics()  # Plot results model$plot_curve() model$plot_roc() } # }  ## ------------------------------------------------ ## Method `SeroCOP$definePrior` ## ------------------------------------------------  if (FALSE) { # \\dontrun{ model <- SeroCOP$new(titre = titre, infected = infected)  # Use default priors centered on data model$definePrior()  # Custom priors model$definePrior(   floor_alpha = 2, floor_beta = 18,    # Stronger prior for low floor   ceiling_alpha = 18, ceiling_beta = 2, # Stronger prior for high ceiling   ec50_mean = 2.0, ec50_sd = 1.0,      # Custom ec50 prior   slope_mean = 0, slope_sd = 1         # More conservative slope ) } # }"},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOPMulti.html","id":null,"dir":"Reference","previous_headings":"","what":"SeroCOPMulti R6 Class for Multi-Biomarker Correlates of Protection Analysis — SeroCOPMulti","title":"SeroCOPMulti R6 Class for Multi-Biomarker Correlates of Protection Analysis — SeroCOPMulti","text":"R6 class analyzing multiple biomarkers simultaneously. Fits separate models biomarker provides comparison tools.","code":""},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOPMulti.html","id":"public-fields","dir":"Reference","previous_headings":"","what":"Public fields","title":"SeroCOPMulti R6 Class for Multi-Biomarker Correlates of Protection Analysis — SeroCOPMulti","text":"titre Matrix antibody titres (columns = biomarkers) infected Binary vector infection status (0/1) biomarker_names Names biomarkers models List fitted SeroCOP objects","code":""},{"path":[]},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOPMulti.html","id":"public-methods","dir":"Reference","previous_headings":"","what":"Public methods","title":"SeroCOPMulti R6 Class for Multi-Biomarker Correlates of Protection Analysis — SeroCOPMulti","text":"SeroCOPMulti$new() SeroCOPMulti$fit_all() SeroCOPMulti$compare_biomarkers() SeroCOPMulti$plot_comparison() SeroCOPMulti$plot_all_curves() SeroCOPMulti$clone()","code":""},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOPMulti.html","id":"method-new-","dir":"Reference","previous_headings":"","what":"Method new()","title":"SeroCOPMulti R6 Class for Multi-Biomarker Correlates of Protection Analysis — SeroCOPMulti","text":"Create new SeroCOPMulti object","code":""},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOPMulti.html","id":"usage","dir":"Reference","previous_headings":"","what":"Usage","title":"SeroCOPMulti R6 Class for Multi-Biomarker Correlates of Protection Analysis — SeroCOPMulti","text":"","code":"SeroCOPMulti$new(titre, infected, biomarker_names = NULL)"},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOPMulti.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"SeroCOPMulti R6 Class for Multi-Biomarker Correlates of Protection Analysis — SeroCOPMulti","text":"titre Matrix antibody titres (rows = samples, cols = biomarkers) infected Binary vector (0/1) infection outcomes biomarker_names Optional vector biomarker names","code":""},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOPMulti.html","id":"returns","dir":"Reference","previous_headings":"","what":"Returns","title":"SeroCOPMulti R6 Class for Multi-Biomarker Correlates of Protection Analysis — SeroCOPMulti","text":"new SeroCOPMulti object","code":""},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOPMulti.html","id":"method-fit-all-","dir":"Reference","previous_headings":"","what":"Method fit_all()","title":"SeroCOPMulti R6 Class for Multi-Biomarker Correlates of Protection Analysis — SeroCOPMulti","text":"Fit models biomarkers","code":""},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOPMulti.html","id":"usage-1","dir":"Reference","previous_headings":"","what":"Usage","title":"SeroCOPMulti R6 Class for Multi-Biomarker Correlates of Protection Analysis — SeroCOPMulti","text":"","code":"SeroCOPMulti$fit_all(   chains = 4,   iter = 2000,   warmup = floor(iter/2),   cores = 1,   ... )"},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOPMulti.html","id":"arguments-1","dir":"Reference","previous_headings":"","what":"Arguments","title":"SeroCOPMulti R6 Class for Multi-Biomarker Correlates of Protection Analysis — SeroCOPMulti","text":"chains Number MCMC chains (default: 4) iter Number iterations per chain (default: 2000) warmup Number warmup iterations (default: iter/2) cores Number cores parallel processing (default: 1) ... Additional arguments passed rstan::sampling","code":""},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOPMulti.html","id":"returns-1","dir":"Reference","previous_headings":"","what":"Returns","title":"SeroCOPMulti R6 Class for Multi-Biomarker Correlates of Protection Analysis — SeroCOPMulti","text":"Self (invisibly)","code":""},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOPMulti.html","id":"method-compare-biomarkers-","dir":"Reference","previous_headings":"","what":"Method compare_biomarkers()","title":"SeroCOPMulti R6 Class for Multi-Biomarker Correlates of Protection Analysis — SeroCOPMulti","text":"Compare biomarkers AUC LOO metrics","code":""},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOPMulti.html","id":"usage-2","dir":"Reference","previous_headings":"","what":"Usage","title":"SeroCOPMulti R6 Class for Multi-Biomarker Correlates of Protection Analysis — SeroCOPMulti","text":"","code":"SeroCOPMulti$compare_biomarkers()"},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOPMulti.html","id":"returns-2","dir":"Reference","previous_headings":"","what":"Returns","title":"SeroCOPMulti R6 Class for Multi-Biomarker Correlates of Protection Analysis — SeroCOPMulti","text":"Data frame comparison metrics","code":""},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOPMulti.html","id":"method-plot-comparison-","dir":"Reference","previous_headings":"","what":"Method plot_comparison()","title":"SeroCOPMulti R6 Class for Multi-Biomarker Correlates of Protection Analysis — SeroCOPMulti","text":"Plot biomarkers AUC vs LOO plane","code":""},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOPMulti.html","id":"usage-3","dir":"Reference","previous_headings":"","what":"Usage","title":"SeroCOPMulti R6 Class for Multi-Biomarker Correlates of Protection Analysis — SeroCOPMulti","text":"","code":"SeroCOPMulti$plot_comparison(add_labels = TRUE)"},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOPMulti.html","id":"arguments-2","dir":"Reference","previous_headings":"","what":"Arguments","title":"SeroCOPMulti R6 Class for Multi-Biomarker Correlates of Protection Analysis — SeroCOPMulti","text":"add_labels Logical, add biomarker labels (default: TRUE)","code":""},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOPMulti.html","id":"returns-3","dir":"Reference","previous_headings":"","what":"Returns","title":"SeroCOPMulti R6 Class for Multi-Biomarker Correlates of Protection Analysis — SeroCOPMulti","text":"ggplot object","code":""},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOPMulti.html","id":"method-plot-all-curves-","dir":"Reference","previous_headings":"","what":"Method plot_all_curves()","title":"SeroCOPMulti R6 Class for Multi-Biomarker Correlates of Protection Analysis — SeroCOPMulti","text":"Plot fitted curves","code":""},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOPMulti.html","id":"usage-4","dir":"Reference","previous_headings":"","what":"Usage","title":"SeroCOPMulti R6 Class for Multi-Biomarker Correlates of Protection Analysis — SeroCOPMulti","text":"","code":"SeroCOPMulti$plot_all_curves()"},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOPMulti.html","id":"returns-4","dir":"Reference","previous_headings":"","what":"Returns","title":"SeroCOPMulti R6 Class for Multi-Biomarker Correlates of Protection Analysis — SeroCOPMulti","text":"ggplot object","code":""},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOPMulti.html","id":"method-clone-","dir":"Reference","previous_headings":"","what":"Method clone()","title":"SeroCOPMulti R6 Class for Multi-Biomarker Correlates of Protection Analysis — SeroCOPMulti","text":"objects class cloneable method.","code":""},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOPMulti.html","id":"usage-5","dir":"Reference","previous_headings":"","what":"Usage","title":"SeroCOPMulti R6 Class for Multi-Biomarker Correlates of Protection Analysis — SeroCOPMulti","text":"","code":"SeroCOPMulti$clone(deep = FALSE)"},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOPMulti.html","id":"arguments-3","dir":"Reference","previous_headings":"","what":"Arguments","title":"SeroCOPMulti R6 Class for Multi-Biomarker Correlates of Protection Analysis — SeroCOPMulti","text":"deep Whether make deep clone.","code":""},{"path":"https://seroanalytics.org/seroCOP/reference/SeroCOPMulti.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"SeroCOPMulti R6 Class for Multi-Biomarker Correlates of Protection Analysis — SeroCOPMulti","text":"","code":"if (FALSE) { # \\dontrun{ # Create multi-biomarker data titres <- matrix(rnorm(600), ncol = 3) colnames(titres) <- c(\"IgG\", \"IgA\", \"Neutralization\") infected <- rbinom(200, 1, 0.3)  # Initialize and fit multi_model <- SeroCOPMulti$new(titre = titres, infected = infected) multi_model$fit_all(chains = 4, iter = 2000)  # Compare biomarkers multi_model$compare_biomarkers() multi_model$plot_comparison() } # }"},{"path":"https://seroanalytics.org/seroCOP/reference/brier_score.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Brier score — brier_score","title":"Calculate Brier score — brier_score","text":"Calculate Brier score probabilistic predictions","code":""},{"path":"https://seroanalytics.org/seroCOP/reference/brier_score.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Brier score — brier_score","text":"","code":"brier_score(observed, predicted)"},{"path":"https://seroanalytics.org/seroCOP/reference/brier_score.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Brier score — brier_score","text":"observed Binary vector observed outcomes (0/1) predicted Vector predicted probabilities","code":""},{"path":"https://seroanalytics.org/seroCOP/reference/brier_score.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Brier score — brier_score","text":"Numeric Brier score (lower better)","code":""},{"path":"https://seroanalytics.org/seroCOP/reference/brier_score.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate Brier score — brier_score","text":"","code":"observed <- c(0, 1, 1, 0, 1) predicted <- c(0.1, 0.8, 0.7, 0.2, 0.9) brier_score(observed, predicted) #> [1] 0.038"},{"path":"https://seroanalytics.org/seroCOP/reference/extract_parameters.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract parameter estimates from SeroCOP fit — extract_parameters","title":"Extract parameter estimates from SeroCOP fit — extract_parameters","text":"Extract posterior summaries model parameters","code":""},{"path":"https://seroanalytics.org/seroCOP/reference/extract_parameters.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract parameter estimates from SeroCOP fit — extract_parameters","text":"","code":"extract_parameters(serocop_obj, prob = 0.95)"},{"path":"https://seroanalytics.org/seroCOP/reference/extract_parameters.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract parameter estimates from SeroCOP fit — extract_parameters","text":"serocop_obj fitted SeroCOP object prob Probability credible intervals (default 0.95)","code":""},{"path":"https://seroanalytics.org/seroCOP/reference/extract_parameters.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract parameter estimates from SeroCOP fit — extract_parameters","text":"Data frame parameter estimates credible intervals","code":""},{"path":"https://seroanalytics.org/seroCOP/reference/seroCOP-package.html","id":null,"dir":"Reference","previous_headings":"","what":"seroCOP: Correlates of Protection Analysis Using Bayesian Methods — seroCOP-package","title":"seroCOP: Correlates of Protection Analysis Using Bayesian Methods — seroCOP-package","text":"Fits generalized logistic functions serological data (antibody titres) infection outcomes using Bayesian methods implemented Stan. Provides tools assessing correlates risk/protection including ROC AUC, LOO-CV, Brier scores. Built around R6 class streamlined workflow.","code":""},{"path":[]},{"path":"https://seroanalytics.org/seroCOP/reference/seroCOP-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"seroCOP: Correlates of Protection Analysis Using Bayesian Methods — seroCOP-package","text":"Maintainer: David Hodgson david.hodgson@example.com","code":""},{"path":"https://seroanalytics.org/seroCOP/reference/simulate_serocop_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate data for correlates of protection analysis — simulate_serocop_data","title":"Simulate data for correlates of protection analysis — simulate_serocop_data","text":"Generate synthetic data four-parameter logistic model testing validation purposes.","code":""},{"path":"https://seroanalytics.org/seroCOP/reference/simulate_serocop_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate data for correlates of protection analysis — simulate_serocop_data","text":"","code":"simulate_serocop_data(   n = 200,   floor = 0.05,   ceiling = 0.9,   ec50 = 1.5,   slope = 2,   titre_mean = 2,   titre_sd = 1.5,   seed = NULL )"},{"path":"https://seroanalytics.org/seroCOP/reference/simulate_serocop_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate data for correlates of protection analysis — simulate_serocop_data","text":"n Number observations floor Lower asymptote (minimum infection probability) ceiling Upper asymptote (maximum infection probability) ec50 Titre 50% floor ceiling slope Steepness curve titre_mean Mean titre distribution (normal) titre_sd Standard deviation titre distribution seed Random seed reproducibility","code":""},{"path":"https://seroanalytics.org/seroCOP/reference/simulate_serocop_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate data for correlates of protection analysis — simulate_serocop_data","text":"list containing: titre Vector simulated titres infected Vector simulated infection outcomes prob_true True infection probabilities params List true parameters used simulation","code":""},{"path":"https://seroanalytics.org/seroCOP/reference/simulate_serocop_data.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate data for correlates of protection analysis — simulate_serocop_data","text":"","code":"# Simulate data with default parameters data <- simulate_serocop_data(n = 200, seed = 123)  # Custom parameters data <- simulate_serocop_data(   n = 500,   floor = 0.02,   ceiling = 0.95,   ec50 = 2.0,   slope = 3.0,   seed = 456 )"}]
