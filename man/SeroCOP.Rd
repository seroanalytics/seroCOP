% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/SeroCOP.R
\name{SeroCOP}
\alias{SeroCOP}
\title{SeroCOP R6 Class}
\description{
An R6 class for analyzing correlates of protection using Bayesian methods.
Fits a four-parameter logistic model to antibody titre and infection outcome data.

This class implements a Bayesian logistic model for analyzing correlates of protection.
It provides methods for model fitting, prediction, performance evaluation, and visualization.
}
\details{
SeroCOP R6 Class for Correlates of Protection Analysis

This class provides a complete workflow for correlates of protection analysis:
\enumerate{
\item Data input and validation
\item Bayesian model fitting using brms (which uses Stan backend)
\item Model diagnostics and validation
\item Performance metrics (ROC AUC, Brier score, LOO-CV)
\item Visualization
}
}
\examples{
\dontrun{
# Create synthetic data
set.seed(123)
n <- 200
titre <- rnorm(n, mean = 2, sd = 1.5)
prob <- 0.05 + 0.9 / (1 + exp(2 * (titre - 1.5)))
infected <- rbinom(n, 1, prob)

# Initialize and fit
model <- SeroCOP$new(titre = titre, infected = infected)
model$fit(chains = 4, iter = 2000)

# Get metrics
model$get_metrics()

# Plot results
model$plot_curve()
model$plot_roc()
}

## ------------------------------------------------
## Method `SeroCOP$definePrior`
## ------------------------------------------------

\dontrun{
model <- SeroCOP$new(titre = titre, infected = infected)

# Use default priors centered on data
model$definePrior()

# Custom priors
model$definePrior(
  floor_alpha = 2, floor_beta = 18,    # Stronger prior for low floor
  ceiling_alpha = 18, ceiling_beta = 2, # Stronger prior for high ceiling
  ec50_mean = 2.0, ec50_sd = 1.0,      # Custom ec50 prior
  slope_mean = 0, slope_sd = 1         # More conservative slope
)
}
}
\concept{r6-classes}
\section{Public fields}{
\if{html}{\out{<div class="r6-fields">}}
\describe{
\item{\code{titre}}{Numeric vector of antibody titres (log scale recommended)}

\item{\code{infected}}{Binary vector of infection status (0/1)}

\item{\code{group}}{Optional factor vector for hierarchical modeling}

\item{\code{fit}}{Stan fit object (after fitting)}

\item{\code{loo}}{LOO-CV object (after fitting)}

\item{\code{priors}}{List of prior distributions for model parameters}
}
\if{html}{\out{</div>}}
}
\section{Methods}{
\subsection{Public methods}{
\itemize{
\item \href{#method-SeroCOP-new}{\code{SeroCOP$new()}}
\item \href{#method-SeroCOP-definePrior}{\code{SeroCOP$definePrior()}}
\item \href{#method-SeroCOP-fit_model}{\code{SeroCOP$fit_model()}}
\item \href{#method-SeroCOP-predict}{\code{SeroCOP$predict()}}
\item \href{#method-SeroCOP-predict_protection}{\code{SeroCOP$predict_protection()}}
\item \href{#method-SeroCOP-extract_group_parameters}{\code{SeroCOP$extract_group_parameters()}}
\item \href{#method-SeroCOP-summary}{\code{SeroCOP$summary()}}
\item \href{#method-SeroCOP-get_metrics}{\code{SeroCOP$get_metrics()}}
\item \href{#method-SeroCOP-plot_curve}{\code{SeroCOP$plot_curve()}}
\item \href{#method-SeroCOP-plot_roc}{\code{SeroCOP$plot_roc()}}
\item \href{#method-SeroCOP-plot_group_curves}{\code{SeroCOP$plot_group_curves()}}
\item \href{#method-SeroCOP-plot_posteriors}{\code{SeroCOP$plot_posteriors()}}
\item \href{#method-SeroCOP-extract_cop}{\code{SeroCOP$extract_cop()}}
\item \href{#method-SeroCOP-clone}{\code{SeroCOP$clone()}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-SeroCOP-new"></a>}}
\if{latex}{\out{\hypertarget{method-SeroCOP-new}{}}}
\subsection{Method \code{new()}}{
Create a new SeroCOP object
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{SeroCOP$new(titre, infected, group = NULL)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{titre}}{Numeric vector of antibody titres}

\item{\code{infected}}{Binary vector (0/1) of infection outcomes}

\item{\code{group}}{Optional factor or character vector for grouping (e.g., age groups)}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
A new SeroCOP object
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-SeroCOP-definePrior"></a>}}
\if{latex}{\out{\hypertarget{method-SeroCOP-definePrior}{}}}
\subsection{Method \code{definePrior()}}{
Define custom prior distributions for model parameters
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{SeroCOP$definePrior(
  floor_alpha = NULL,
  floor_beta = NULL,
  ceiling_alpha = NULL,
  ceiling_beta = NULL,
  ec50_mean = NULL,
  ec50_sd = NULL,
  slope_mean = NULL,
  slope_sd = NULL
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{floor_alpha}}{Alpha parameter for floor beta prior (default: 1)}

\item{\code{floor_beta}}{Beta parameter for floor beta prior (default: 9)}

\item{\code{ceiling_alpha}}{Alpha parameter for ceiling beta prior (default: 9)}

\item{\code{ceiling_beta}}{Beta parameter for ceiling beta prior (default: 1)}

\item{\code{ec50_mean}}{Mean for ec50 normal prior (default: midpoint of titre range)}

\item{\code{ec50_sd}}{SD for ec50 normal prior (default: titre range / 4)}

\item{\code{slope_mean}}{Mean for slope normal prior (default: 0)}

\item{\code{slope_sd}}{SD for slope normal prior (default: 2)}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
Self (invisibly)
}
\subsection{Examples}{
\if{html}{\out{<div class="r example copy">}}
\preformatted{\dontrun{
model <- SeroCOP$new(titre = titre, infected = infected)

# Use default priors centered on data
model$definePrior()

# Custom priors
model$definePrior(
  floor_alpha = 2, floor_beta = 18,    # Stronger prior for low floor
  ceiling_alpha = 18, ceiling_beta = 2, # Stronger prior for high ceiling
  ec50_mean = 2.0, ec50_sd = 1.0,      # Custom ec50 prior
  slope_mean = 0, slope_sd = 1         # More conservative slope
)
}
}
\if{html}{\out{</div>}}

}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-SeroCOP-fit_model"></a>}}
\if{latex}{\out{\hypertarget{method-SeroCOP-fit_model}{}}}
\subsection{Method \code{fit_model()}}{
Fit the Bayesian logistic model
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{SeroCOP$fit_model(chains = 4, iter = 2000, warmup = 1000, thin = 1, ...)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{chains}}{Number of MCMC chains (default: 4)}

\item{\code{iter}}{Number of iterations per chain (default: 2000)}

\item{\code{warmup}}{Number of warmup iterations (default: iter/2)}

\item{\code{thin}}{Thinning interval (default: 1)}

\item{\code{...}}{Additional arguments passed to brms::brm}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
Self (invisibly)
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-SeroCOP-predict"></a>}}
\if{latex}{\out{\hypertarget{method-SeroCOP-predict}{}}}
\subsection{Method \code{predict()}}{
Get posterior predictions for infection probability
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{SeroCOP$predict(newdata = NULL)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{newdata}}{Optional new titre values for prediction}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
Matrix of posterior predictions (iterations x observations)
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-SeroCOP-predict_protection"></a>}}
\if{latex}{\out{\hypertarget{method-SeroCOP-predict_protection}{}}}
\subsection{Method \code{predict_protection()}}{
Extract probability of protection from the fitted model
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{SeroCOP$predict_protection(newdata = NULL)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{newdata}}{Optional vector of new titre values for prediction}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
Matrix of protection probabilities (rows = MCMC samples, cols = observations)
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-SeroCOP-extract_group_parameters"></a>}}
\if{latex}{\out{\hypertarget{method-SeroCOP-extract_group_parameters}{}}}
\subsection{Method \code{extract_group_parameters()}}{
Extract group-specific parameters from hierarchical model
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{SeroCOP$extract_group_parameters()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
A data.frame with group-specific parameter estimates (NULL if not hierarchical)
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-SeroCOP-summary"></a>}}
\if{latex}{\out{\hypertarget{method-SeroCOP-summary}{}}}
\subsection{Method \code{summary()}}{
Get summary statistics for model parameters
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{SeroCOP$summary()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
Data frame with parameter summaries
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-SeroCOP-get_metrics"></a>}}
\if{latex}{\out{\hypertarget{method-SeroCOP-get_metrics}{}}}
\subsection{Method \code{get_metrics()}}{
Calculate performance metrics
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{SeroCOP$get_metrics()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
List containing ROC AUC, Brier score, and LOO-CV metrics
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-SeroCOP-plot_curve"></a>}}
\if{latex}{\out{\hypertarget{method-SeroCOP-plot_curve}{}}}
\subsection{Method \code{plot_curve()}}{
Plot the fitted curve with uncertainty
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{SeroCOP$plot_curve(title = "Correlates of Risk Curve", ...)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{title}}{Plot title}

\item{\code{...}}{Additional arguments passed to ggplot2}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
A ggplot object
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-SeroCOP-plot_roc"></a>}}
\if{latex}{\out{\hypertarget{method-SeroCOP-plot_roc}{}}}
\subsection{Method \code{plot_roc()}}{
Plot ROC curve
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{SeroCOP$plot_roc(title = "ROC Curve")}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{title}}{Plot title}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
A ggplot object
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-SeroCOP-plot_group_curves"></a>}}
\if{latex}{\out{\hypertarget{method-SeroCOP-plot_group_curves}{}}}
\subsection{Method \code{plot_group_curves()}}{
Plot group-specific curves for hierarchical models
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{SeroCOP$plot_group_curves(title = "Group-Specific Correlates of Risk")}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{title}}{Plot title}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
A ggplot object (returns NULL if not a hierarchical model)
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-SeroCOP-plot_posteriors"></a>}}
\if{latex}{\out{\hypertarget{method-SeroCOP-plot_posteriors}{}}}
\subsection{Method \code{plot_posteriors()}}{
Plot posterior distributions of parameters
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{SeroCOP$plot_posteriors()}\if{html}{\out{</div>}}
}

\subsection{Returns}{
A ggplot object
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-SeroCOP-extract_cop"></a>}}
\if{latex}{\out{\hypertarget{method-SeroCOP-extract_cop}{}}}
\subsection{Method \code{extract_cop()}}{
Extract the correlate of protection conditional on exposure.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{SeroCOP$extract_cop(correlate_of_risk, upper_bound = 0.7)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{correlate_of_risk}}{Numeric vector of correlates of risk.}

\item{\code{upper_bound}}{Numeric value for the upper bound (default: 0.7).}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
Numeric vector of correlates of protection.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-SeroCOP-clone"></a>}}
\if{latex}{\out{\hypertarget{method-SeroCOP-clone}{}}}
\subsection{Method \code{clone()}}{
The objects of this class are cloneable with this method.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{SeroCOP$clone(deep = FALSE)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{deep}}{Whether to make a deep clone.}
}
\if{html}{\out{</div>}}
}
}
}
